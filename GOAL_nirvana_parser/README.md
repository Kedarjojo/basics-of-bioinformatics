GOAL Nirvana Annotation Parser
GitHub README File

A toolkit for parsing Nirvana JSON output from the GOAL DRAGEN pipeline and generating a clean, analysis-ready TSV with correct transcript selection.

Description

This project processes the Nirvana-annotated JSON generated by the DRAGEN pipeline for the GOAL assay. The goal is to extract variant annotations, select the correct transcript per variant, and output a standardized TSV file suitable for manual review and downstream analysis.

The GOAL DRAGEN assay produces:

An unannotated VCF

A Nirvana-annotated JSON (*.vcf.annotated.json.gz)

Nirvana contains detailed variant information including HGVS annotations, gene and transcript metadata, variant consequences, and population frequencies. Because annotation accuracy depends heavily on choosing the correct transcript, this project implements structured transcript selection using MANE Select and RefSeq rules.

All code should be validated through unit tests and spot-checking using representative variant cases.

Features

Parses the positions block of Nirvana JSON

Keeps only variants with filters == "PASS"

Splits multiple variants at a single position into separate rows

Selects one transcript per variant using:

MANE Select transcript (primary rule)

Fallback: biotype == "mRNA" and isCanonical == true

Produces a TSV with all required annotation fields

Supports samples with or without CNV backbone

Designed for reproducibility and validation

Input

Nirvana JSON file, for example:

/GOAL/Results/Run5/.../GX22-1031_017.hard-filtered.vcf.annotated.json.gz


Only the positions section of the JSON is used.
Each position entry corresponds to a variant present in the unannotated VCF.

Transcript Selection
Primary method

Use the latest MANE Select RefSeq transcripts

Validate Nirvanaâ€™s isManeSelect flag against the MANE GTF (MANE.GRCh38.v1.4.refseq_genomic.gtf)

Fallback logic

When MANE is not available:

Prefer transcripts where:

biotype == "mRNA"

isCanonical == true

This ensures a single, deterministic transcript is selected for each variant.

Output

The final output is a TSV where each row represents a variant.

Required fields include:

Variant fields

Chromosome

Position

refAllele

altAllele(s)

Filters

mappingQuality

cytogeneticBand

genotype

variantFrequencies

totalDepth

alleleDepths

somaticQuality

variantType

hgvsg

ClinVar fields

ID

significance

reviewStatus

(Include only entries matching the variant ref/alt)

(Combine multiple entries with a delimiter)

Population frequencies

dbsnp ID

globalMinorAlleleFrequency (if globalMinorAllele matches alt)

gnomad allAF

oneKg allAF

topmed allAF

COSMIC

COSMIC IDs (if any)

Transcript fields

Transcript name (RefSeq)

biotype

exon or intron notation (e.g., exon 21/24 or intron 3/3)

hgnc

consequence (combined if multiple)

hgvsc

hgvsp (if present)

Validation

Validate all logic using:

Unit tests for parsing and transcript selection

Both simple and complex representative variants

Manual spot-checking to confirm annotation accuracy
